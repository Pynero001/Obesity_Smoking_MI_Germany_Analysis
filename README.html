<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.54">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>readme</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="README_files/libs/clipboard/clipboard.min.js"></script>
<script src="README_files/libs/quarto-html/quarto.js"></script>
<script src="README_files/libs/quarto-html/popper.min.js"></script>
<script src="README_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="README_files/libs/quarto-html/anchor.min.js"></script>
<link href="README_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="README_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="README_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="README_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="README_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://mybinder.org/v2/gh/Pynero001/Obesity_Smoking_MI_Germany_Analysis/HEAD?labpath=Obesity_Smoking_MI_Germany_Analysis.ipynb"><img src="https://mybinder.org/badge_logo.svg" class="img-fluid figure-img" alt="Click on the Binder badge above to view the interactive notebook"></a></p>
<figcaption>Click on the Binder badge above to view the interactive notebook</figcaption>
</figure>
</div>
<p>To ensure the plots are interactive, run</p>
<p><code>pio.renderers.default = 'iframe'</code></p>
<hr>
<section id="evaluating-obesity-smoking-and-myocardial-infarction-rates-in-germany-a-retrospective-analysis-for-sdg-3" class="level2">
<h2 class="anchored" data-anchor-id="evaluating-obesity-smoking-and-myocardial-infarction-rates-in-germany-a-retrospective-analysis-for-sdg-3">Evaluating Obesity, Smoking and Myocardial Infarction Rates in Germany: A Retrospective Analysis for SDG 3</h2>
<section id="introduction" class="level4">
<h4 class="anchored" data-anchor-id="introduction"><strong>Introduction</strong></h4>
<p>Key tenets of the <a href="https://www.un.org/sustainabledevelopment/health/">Sustainable Development Goals (SDGs)</a> by 2030 include ensuring optimal health and preventing deaths from non-communicable diseases; cardiovascular diseases are the leading cause of these deaths. The global implementation of tobacco control is also a critical focus.</p>
<p>In this project, I will analyse the most recent data (2021) from the German Federal Statistical Office (<a href="https://www.destatis.de/EN/"><em>Statistisches Bundesamt</em></a>) to assess Germany’s progress towards the aforementioned goals. Additionally, the project will also explore the influence of obesity and smoking on the prevalence of myocardial infarction across Germany’s 16 federal states.</p>
</section>
<section id="a-closer-look-at-the-variables-of-interest" class="level4">
<h4 class="anchored" data-anchor-id="a-closer-look-at-the-variables-of-interest">A closer look at the variables of interest</h4>
</section>
<section id="obesity" class="level4">
<h4 class="anchored" data-anchor-id="obesity">1. OBESITY</h4>
<p><img src="./images/obese_duo.jpg" alt="Obese duo" width="80%" height="50%"></p>
<p>Obesity, defined as a <em>BMI greater than 30</em>, is a risk factor for a myriad of potentially fatal diseases including:</p>
<ul>
<li>Cardiovascular diseases: Hypertension, coronary artery disease and stroke.</li>
<li>Metabolic disorders: Type II Diabetes Mellitus and metabolic syndrome.</li>
<li>Respiratory disorders: Obstructive sleep apnea and asthma.</li>
<li>Reproductive disorders: Infertility, polycystic ovarian syndrome, preterm delivery and fetal macrosomia.</li>
<li>Psychological disorders: Depression.</li>
<li>Cancer: Breast cancer, prostate cancer, ovarian cancer and many other cancers have been linked to obesity.</li>
</ul>
</section>
<section id="is-germany-having-an-obesity-crisis" class="level4">
<h4 class="anchored" data-anchor-id="is-germany-having-an-obesity-crisis">Is Germany having an obesity crisis?</h4>
<p><img src="./images/obese_trend.png" class="img-fluid"></p>
<p>As shown the line plot above, the overall trends in obesity rates reveal a significant increase over the past decades, posing a serious blow to Germany’s progress towards SDG.</p>
<p><img src=".\images/obese_map_trend.gif" class="img-fluid"></p>
<p>As of 2021,</p>
<p>Top 3 States with the <strong>Healthiest BMI (Lowest Obesity Rates)</strong> were:</p>
<ul>
<li><p>Hamburg (12.6%)</p></li>
<li><p>Berlin (13.8%)</p></li>
<li><p>Baden-Wurttemberg (15.1%)</p></li>
</ul>
<p>Bottom 3 States with the <strong>Worst BMI (Highest Obesity Rates)</strong> were:</p>
<ul>
<li><p>Mecklenburg Western Pomerania (21.2%)</p></li>
<li><p>Thuringia (19.1%)</p></li>
<li><p>Saxony Anhalt (18.9%)</p></li>
</ul>
<p><img src=".\images/BMI_state.png" class="img-fluid"></p>
<p>While comparing the proportion of obese people in 2017 with recent data, <strong>Saxony Anhalt</strong>, <strong>Thuringia</strong> and <strong>Saxony</strong> saw the greatest declines in obesity rates nationwide, with percentage <em>decreases</em> of 9.2%, 6.4% and 5.3%, respectively. On the flip side, the obesity rates went up in <strong>Saarland</strong>, <strong>Schleswig-Holstein</strong> and <strong>Lower Saxony</strong> by 13.3%, 12.3% and 10.8%, respectively.</p>
</section>
<section id="smoking" class="level4">
<h4 class="anchored" data-anchor-id="smoking">2. SMOKING</h4>
<p><img src="./images/smoke_lady.jpeg" alt="smoking lady" width="80%" height="50%"></p>
<p>Smoking, though commonly associated with the inhalation &amp; exhalation of tobacco products, also encompasses non-tobacco products such as marijuana, e-cigarettes and other substances. However, tobacco consumption being a well-known risk factor for several diseases has remained the target for anti-smoking campaigns, some of which include:</p>
<ul>
<li>Cardiovascular diseases: Atherosclerosis, hypertension, coronary artery disease, peripheral vascular diseases, stroke.</li>
<li>Metabolic disorders: Type II Diabetes Mellitus.</li>
<li>Respiratory disorders: Chronic obstructive pulmonary disease, asthma, pneumonia.</li>
<li>Reproductive disorders: Infertility, birth defects.</li>
<li>Psychological disorders: Substance use disorder, schizophrenia, depression. There is a reciprocal causality whereby the use of tobacco can lead to psychiatric illnesses and vice versa.</li>
<li>Cancer: Lung cancer, mouth and throat cancers, bladder cancer, cervical cancer.</li>
</ul>
</section>
<section id="achieving-a-tobacco-free-germany-progress-so-far.." class="level4">
<h4 class="anchored" data-anchor-id="achieving-a-tobacco-free-germany-progress-so-far..">Achieving a Tobacco-Free Germany: Progress so far..</h4>
<p><img src="./images/smoke_trend.png" class="img-fluid"></p>
<p>The figure above shows that there has been an impressive decline in smoking rates over the years across Germany. Despite the decline, proportion of smokers remained significant with the best state, Bavaria, having nearly one-fifth of its population as smokers.</p>
<p><img src="./images/smoke_map_trend.gif" class="img-fluid"></p>
<p>Below are the rankings of the German states based on proportion of the population above 15 years of age who smoke at least occasionally, based on the 2021 survey:</p>
<p>Top 3 States with the <strong>Lowest Proportion of Smokers</strong></p>
<ul>
<li><p>Bavaria (17.0%)</p></li>
<li><p>Baden-Wurttemberg (17.4%)</p></li>
<li><p>Saarland (18.5%)</p></li>
</ul>
<p>Bottom 3 States with the <strong>Highest Proportion of Smokers</strong></p>
<ul>
<li><p>Mecklenburg Western Pomerania (23.9%)</p></li>
<li><p>Thuringia (23.4%)</p></li>
<li><p>Bremen (22.7%)</p></li>
</ul>
<p><img src=".\images/smoking_by_state.png" class="img-fluid"></p>
</section>
<section id="prevalence-of-acute-myocardial-infarction-in-germany" class="level4">
<h4 class="anchored" data-anchor-id="prevalence-of-acute-myocardial-infarction-in-germany">Prevalence of Acute Myocardial Infarction in Germany</h4>
<p><img src="./images/chestpain.jpg" alt="angina" width="80%" height="50%"></p>
<p>Acute Myocardial infarction (AMI), popularly referred to as <em>heart attack</em>, belongs to the group of ischemic heart diseases and occurs when there is insufficient supply of oxygen to the heart.</p>
<p>It is among the health metrics measured by EU countries under the <strong>European Community Health Indicators</strong> framework. The data used in this analysis was obtained from the <a href="https://www.gbe-bund.de/gbe/">Federal Health Reporting (GBE)</a> survey conducted by the <strong>Robert Koch Institute</strong> and contains record of age-standardized heart attack rates (both first and recurrent attacks) from 2000-2022 by state.</p>
<p>While focusing on the trends in the attack rates from 2010 till 2022, a general decline in the incidence was observed.</p>
<p><img src=".\images/MI_trend.png" class="img-fluid"></p>
<p>In 2021, the worst-hit German states ranked in terms of case counts of myocardial infarction per 100,000 people were as follows:</p>
<ul>
<li>Saarland (405.2)</li>
<li>Bremen (375.3)</li>
<li>Mecklenburg Western Pomerania (370.4)</li>
</ul>
<p><img src=".\images/MI_by_state.png" class="img-fluid"></p>
<p><img src=".\images/mir_2021.png" class="img-fluid"></p>
</section>
<section id="the-burning-question" class="level4">
<h4 class="anchored">THE BURNING QUESTION:</h4>
<ul>
<li><em>Were there any <strong>statistically significant differences</strong> in MI attack rates based on the proportion of smoking or obese individuals in 2021?</em></li>
</ul>
<p>On assessing the relationship between obesity, smoking and the prevalence of myocardial infarction using a Pearson correlation heat map, there seemed to be a strong linear relationship between being <em>obese</em> and <em>myocardial infarction</em> from the data. However, the relationship between <em>smoking</em> and <em>myocardial infarction</em> was fairly strong.</p>
<p><img src=".\images/corr.png" class="img-fluid"></p>
<p>A simple linear regression analysis was done to measure the statistical significance in the relationship between smoking, obesity and myocardial infarction rate.</p>
<h3 class="anchored" data-anchor-id="the-burning-question">
<font color="cyan">Key Insights</font>
</h3>
<ul>
<li><p>Based on the results of the linear regression analysis and an alpha level of 0.05, it can be deduced that there was a significant association (p=0.0082) between the obesity rate and the prevalence of acute myocardial infarction in Germany in 2021.</p></li>
<li><p>Although smoking is a known risk factor for cardiovascular disease, there was insufficient evidence (p=0.341) to establish a relationship between the smoking rate and the prevalence of myocardial infarction in 2021. This could be as a result of limitations in data collection methods (as reported by the German Federal Statistical Office (<em>Statistisches Bundesamt</em>) <a href="https://www.destatis.de/EN/Themes/Society-Environment/Population/Households-Families/Methods/microcensus-2020.html#586042">here</a>). The inclusion criteria for smoking rate in the study were also broad, encompassing a wide range of participants from occasional to heavy smokers which could have weakened the expected association.</p></li>
<li><p>An analysis of the overall trends in obesity, smoking and myocardial infarction rates over the past decades revealed a decline in smoking and MI rates while obesity has been on the rise.</p></li>
</ul>
<h3 class="anchored">
<font color="cyan">My Recommendations</font>
</h3>
<p>Mecklenburg Western Pomerania, Bremen and Thuringia performed poorly across nearly all the metrics in 2021, highlighting the need for targeted interventions and policies in order to ensure alignment with the Sustainable Development Goals. Based on the results of the analysis, I propose the following recommendations to address key issues identified:</p>
<ul>
<li>Improved access to specialised healthcare centres to ensure early detection and prevention of heart diseases.</li>
<li>Subsidies on healthy, heart-friendly foods.</li>
<li>Promotion of healthy eating habits and physical activity.</li>
<li>Adequate support for those with psychological eating disorders.</li>
<li>Health promotion campaigns to create increased awareness about the dangers of smoking.</li>
<li>Higher taxation on tobacco products.</li>
<li>More stringent rules on advertisements and sale of tobacco products.</li>
<li>Affordable access to smoke cessation and weight loss programs.</li>
</ul>
<hr>
<p><strong>PACKAGES</strong></p>
<ul>
<li><p>Kaleido v0.2.1</p></li>
<li><p>Geopandas v1.0.1</p></li>
<li><p>Numpy v2.0.0</p></li>
<li><p>Pandas v2.2.2</p></li>
<li><p>PIL v10.4.0</p></li>
<li><p>Pingouin v0.5.5</p></li>
<li><p>Plotly v5.23.0</p></li>
<li><p>Print_versions v0.1.0</p></li>
<li><p>Scipy v1.14.0</p></li>
</ul>
<p><strong>REFERENCES</strong></p>
<ul>
<li>Obesity - <a href="https://emedicine.medscape.com/article/123702-overview?form=fpf">Mesdcape</a></li>
<li>Impact of Tobacco Smoking and Smoking Cessation on Cardiovascular Risk and Disease - <a href="https://www.medscape.com/viewarticle/577468_7">Mesdcape</a></li>
</ul>
<p><strong>DATASET SOURCES</strong></p>
<p><a href="https://www.statistikportal.de/de/nachhaltigkeit/veroeffentlichungen">SDG Indicators - Germany</a></p>
<p><a href="https://www.gbe-bund.de/gbe/">European Community Health Indicators - Acute Myocardial Infarction</a></p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>